{% extends 'base.html' %}

{% block title %}Trang chủ - Hệ thống Quản lý Khảo sát{% endblock %}

{% block content %}
<div class="hero-section">
    <h1 class="display-4 mb-3">
        <i class="bi bi-clipboard-data"></i> Hệ thống Quản lý Khảo sát
    </h1>
    <p class="lead">Tạo và quản lý khảo sát một cách dễ dàng và chuyên nghiệp</p>
    {% if user.is_authenticated %}
    <a href="{% url 'surveys:survey_create' %}" class="btn btn-light btn-lg mt-3">
        <i class="bi bi-plus-circle"></i> Tạo khảo sát mới
    </a>
    {% else %}
    <a href="{% url 'admin:login' %}" class="btn btn-light btn-lg mt-3">
        <i class="bi bi-box-arrow-in-right"></i> Đăng nhập để bắt đầu
    </a>
    {% endif %}
</div>

<!-- Search Bar -->
<div class="card mb-4">
    <div class="card-body">
        <form method="get" action="{% url 'surveys:home' %}">
            <div class="input-group">
                <span class="input-group-text">
                    <i class="bi bi-search"></i>
                </span>
                <input type="text" class="form-control" name="search" 
                       placeholder="Tìm kiếm khảo sát..." value="{{ search_query }}">
                <button class="btn btn-primary" type="submit">Tìm kiếm</button>
            </div>
        </form>
    </div>
</div>

<!-- Survey List -->
<h2 class="mb-4">
    <i class="bi bi-list-check"></i> Khảo sát đang hoạt động
    <span class="badge bg-primary">{{ surveys.count }}</span>
</h2>

{% if surveys %}
<div class="row">
    {% for survey in surveys %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">{{ survey.title }}</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">{{ survey.description|truncatewords:20 }}</p>
                <div class="mb-3">
                    <small class="text-muted">
                        <i class="bi bi-person"></i> {{ survey.creator.username }}<br>
                        <i class="bi bi-calendar"></i> {{ survey.created_at|date:"d/m/Y" }}<br>
                        <i class="bi bi-chat-dots"></i> {{ survey.response_count }} phản hồi
                    </small>
                </div>
                {% if survey.expires_at %}
                <div class="mb-2">
                    <small class="badge bg-warning">
                        <i class="bi bi-clock"></i> Hết hạn: {{ survey.expires_at|date:"d/m/Y H:i" }}
                    </small>
                </div>
                {% endif %}
            </div>
            <div class="card-footer bg-transparent">
                <a href="{% url 'surveys:survey_detail' survey.pk %}" class="btn btn-sm btn-primary w-100">
                    <i class="bi bi-eye"></i> Xem chi tiết
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    <i class="bi bi-info-circle"></i> 
    {% if search_query %}
    Không tìm thấy khảo sát nào phù hợp với từ khóa "{{ search_query }}".
    {% else %}
    Chưa có khảo sát nào. Hãy tạo khảo sát đầu tiên của bạn!
    {% endif %}
</div>
{% endif %}
{% endblock %}

